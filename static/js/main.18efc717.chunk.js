(this["webpackJsonpmy-first-app"]=this["webpackJsonpmy-first-app"]||[]).push([[0],{107:function(e,t,n){e.exports={mainContent:"Profile_mainContent__1ugrA"}},14:function(e,t,n){e.exports={person:"Person_person__dqu7b",personTopimg:"Person_personTopimg__1oXv5",personData:"Person_personData___TEmU",personDataAva:"Person_personDataAva__32tJ_",personDataDesc:"Person_personDataDesc__2PTCe",personDataDescName:"Person_personDataDescName__3w5F6",personStatus:"Person_personStatus__3xKwM",personDataDescDesc:"Person_personDataDescDesc__1Prel"}},172:function(e,t,n){},173:function(e,t,n){},216:function(e,t,n){"use strict";n.r(t);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var a,r=n(6),o=n(11),s=n(54),c=function(e,t){var n=e,a=t.profile.posts.length;return[].concat(Object(s.a)(t.profile.posts),[{id:a,message:n,likes:100}])},l=function(e){return e},u="SET-AUTH-USER-DATA",i="REM-AUTH-USER-DATA",m="CHANGE_USER_DATA",p={profile:{name:null,login:null,password:null,status:"Life is wonderful",aboutMe:"Hey, I'm a new user in TyppaTwitter",lookingForAJob:"No",posts:[],isAuth:!1}},f=function(e){return{type:m,data:e}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(a=e,t.type){case u:return Object(o.a)(Object(o.a)({},e),{},{profile:Object(o.a)(Object(o.a)({},e.profile),t.data)});case i:return Object(o.a)(Object(o.a)({},e),{},{isAuth:!1});case m:return Object(o.a)(Object(o.a)({},e),{},{profile:Object(o.a)(Object(o.a)({},e.profile),t.data)});default:return e}},b={friends:[{id:1,name:"Andrey"},{id:2,name:"Zabit"},{id:3,name:"Khabib"}]},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b;return e},E=n(51),_=n.n(E),v=n(52),h=n.n(v),O=n(104),P=n(219),j=Object(r.c)({profilePage:d,navbarPage:g,usersPage:_.a,auth:h.a,form:P.a}),D=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||r.d,N=Object(r.e)(j,D(Object(r.a)(O.a))),k=n(0),A=n.n(k),S=n(49),y=n.n(S),w=n(21),M=(n(172),n(173),n(107)),T=n.n(M),x=n(14),L=n.n(x),C=n(17),I=function(e){var t=e[0],n=e[1],a=Object(k.useState)(!1),r=Object(C.a)(a,2),o=r[0],s=r[1],c=Object(k.useState)(t),l=Object(C.a)(c,2),u=l[0],i=l[1];return A.a.createElement("div",{className:L.a.personStatus},!1===o?A.a.createElement("div",null,A.a.createElement("p",{onDoubleClick:function(){s(!0)}},u)):A.a.createElement("div",null,A.a.createElement("input",{onChange:function(e){return function(e){var t=e.target.value;i(t)}(e)},autoFocus:!0,onBlur:function(){s(!1),n(u)},value:u})))},U=n.p+"static/media/brain.87fe3c8f.jpg",H=function(e){var t=[e.profile.status,e.changeStatus],n=[e.profile.aboutMe,e.changeAboutMe],a=[e.profile.lookingForAJob,e.changeLooking];return A.a.createElement("div",{className:L.a.person},A.a.createElement("div",{className:L.a.personTopimg}),A.a.createElement("div",{className:L.a.personData},A.a.createElement("img",{src:U,alt:"avatar",className:L.a.personDataAva}),A.a.createElement("div",{className:L.a.personDataDesc},A.a.createElement("p",{className:L.a.personDataDescName},e.profile.name),A.a.createElement("div",{className:L.a.personDataDescDesc},A.a.createElement("b",null,"\u0421\u0442\u0430\u0442\u0443\u0441: "),A.a.createElement(I,t)),A.a.createElement("div",{className:L.a.personDataDescDesc},A.a.createElement("b",null,"\u041e\u0431\u043e \u043c\u043d\u0435: "),A.a.createElement(I,n)),A.a.createElement("div",{className:L.a.personDataDescDesc},A.a.createElement("b",null,"\u0421\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043e \u0440\u0430\u0431\u043e\u0442\u0435: "),A.a.createElement(I,a)))))},F=n(8),J=n(218),R=n(217),q=function(e){if(!e)return"Field is required"},B=n(80),G=n(55),X=n.n(G),K=function(e){var t=e.input,n=e.meta,a=Object(B.a)(e,["input","meta"]),r=n.touched&&n.error;return A.a.createElement("div",{className:r?X.a.error:X.a.formDiv},A.a.createElement("input",Object.assign({},t,a)),r?A.a.createElement("span",null,n.error):null)},W=function(e){var t=e.input,n=(e.meta,Object(B.a)(e,["input","meta"]));return A.a.createElement("div",{className:X.a.formDiv},"remember me?",A.a.createElement("input",Object.assign({},t,n,{type:"checkbox"})))},Z=n(27),V=n.n(Z),Y=n(40),$=n.n(Y),z=function(e){return A.a.createElement("div",{className:$.a.postsPost},A.a.createElement("div",{className:$.a.postsPostImg}),A.a.createElement("p",{className:$.a.postsPostTxt},e.message),A.a.createElement("p",{className:$.a.postsPostLike},"like: ",e.likes))},Q=function(e){return function(t){if(t.length>e)return"Max length is ".concat(e," symbols")}}(30),ee=Object(R.a)({form:"AddNewPostForm"})((function(e){return A.a.createElement("form",{onSubmit:e.handleSubmit},A.a.createElement(J.a,{validate:[q,Q],name:"postText",component:K,placeholder:"your news..."}),A.a.createElement("button",{className:V.a.postsMenuSend},"Add post"))})),te=function(e){var t=Object(s.a)(e.posts).reverse().map((function(e){return A.a.createElement(z,{key:e.id,likes:e.likes,message:e.message})}));return A.a.createElement("div",{className:V.a.postsArea},A.a.createElement("div",{className:V.a.postsMenu},A.a.createElement("p",{className:V.a.postsMenuHeader},"My posts"),A.a.createElement(ee,{onSubmit:function(t){e.addPost(t.postText)}})),A.a.createElement("div",{className:V.a.posts},t.length?t:A.a.createElement("p",{className:V.a.postsHeader},"You haven't posted anything yet")))},ne=Object(F.b)((function(e){return{posts:e.profilePage.profile.posts}}),{addPost:function(e){return function(t){var n=c(e,a);t(f({posts:n}))}}})(te),ae=function(e){return A.a.createElement(A.a.Fragment,null,A.a.createElement(H,Object.assign({},e,{profile:e.profile})),A.a.createElement(ne,null))},re=n(7),oe=function(e){return{isAuth:e.profilePage.profile.isAuth}},se=function(e){return e.profilePage.profile},ce=Object(r.d)(Object(F.b)((function(e){return{profile:se(e)}}),{changeStatus:function(e){return function(t){var n=l(e);t(f({status:n}))}},changeAboutMe:function(e){return function(t){var n=l(e);t(f({aboutMe:n}))}},changeLooking:function(e){return function(t){var n=l(e);t(f({looking:n}))}}}),re.g,(function(e){return Object(F.b)(oe)((function(t){return t.isAuth?A.a.createElement(e,t):A.a.createElement(re.a,{to:"/login"})}))}))((function(e){return A.a.createElement("div",{className:T.a.mainContent},A.a.createElement(ae,e))})),le=function(e){return e.profilePage.profile.isAuth},ue=function(e){return e.profilePage.profile.name},ie=n(78),me=n.n(ie),pe=function(e){return A.a.createElement("header",{className:me.a.header},A.a.createElement("p",{className:me.a.logo},"TyppaTwitter"),e.isAuth?A.a.createElement("div",null,A.a.createElement("p",null,e.name),A.a.createElement("button",{onClick:e.remAuthUserData},"Log out")):A.a.createElement(w.b,{to:"/login"},A.a.createElement("p",null,"Log in")))},fe=Object(F.b)((function(e){return{isAuth:le(e),name:ue(e)}}),{getUsers:E.getUsers,remAuthUserData:v.remAuthUserData})((function(e){return A.a.createElement(pe,e)})),de=n(24),be=n.n(de),ge=n(39),Ee=n(79),_e=n.n(Ee);function ve(){}var he=Object(k.createContext)({token:null,userId:null,login:ve,logout:ve,isAuthentificated:!1}),Oe=Object(R.a)({form:"login"})((function(e){return A.a.createElement("form",{onSubmit:e.handleSubmit},A.a.createElement("div",null,A.a.createElement(J.a,{placeholder:"Login",name:"login",validate:[q],component:K})),A.a.createElement("div",null,A.a.createElement(J.a,{placeholder:"Password",name:"password",validate:[q],component:K})),"login"===e.authMode?A.a.createElement("div",null,A.a.createElement(J.a,{placeholder:"",name:"rememberMe",validate:[],component:W})):"",A.a.createElement("div",null,A.a.createElement("button",{disabled:e.loading},"Enter")),A.a.createElement("div",{className:_e.a.summaryError},e.error?A.a.createElement("p",null,e.error):""))})),Pe=Object(F.b)((function(e){return{isAuth:le(e)}}),{setAuthUserData:function(e){var t=e.login,n=e.password;return{type:u,data:{login:t,password:n,name:t,isAuth:!0}}}})((function(e){var t=Object(k.useState)("login"),n=Object(C.a)(t,2),a=n[0],r=n[1],s=function(e){return r(e)},c=function(){var e=Object(k.useState)(!1),t=Object(C.a)(e,2),n=t[0],a=t[1],r=Object(k.useState)(null),o=Object(C.a)(r,2),s=o[0],c=o[1];return{loading:n,request:Object(k.useCallback)(function(){var e=Object(ge.a)(be.a.mark((function e(t){var n,r,o,s,l,u=arguments;return be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:"GET",r=u.length>2&&void 0!==u[2]?u[2]:null,o=u.length>3&&void 0!==u[3]?u[3]:{},a(!0),e.prev=4,r&&(r=JSON.stringify(r),o["Content-Type"]="application/json"),e.next=9,fetch(t,{method:n,body:r,headers:o});case 9:return s=e.sent,e.next=12,s.json();case 12:if(l=e.sent,s.ok){e.next=15;break}throw new Error(l.message||"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a");case 15:return a(!1),e.abrupt("return",l);case 19:throw e.prev=19,e.t0=e.catch(4),a(!1),c(e.t0.message),e.t0;case 24:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(t){return e.apply(this,arguments)}}(),[]),error:s,clearError:Object(k.useCallback)((function(){return c(null)}),[])}}(),l=c.loading,u=c.request,i=c.error,m=c.clearError,p=function(){var e=Object(ge.a)(be.a.mark((function e(t){return be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u("/api/auth/register","POST",Object(o.a)({},t));case 3:e.sent,e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var t=Object(ge.a)(be.a.mark((function t(n){var a;return be.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u("/api/auth/login","POST",Object(o.a)({},n));case 3:a=t.sent,console.log(a),d.login(a.token,a.userId),e.setAuthUserData(n),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}();Object(k.useEffect)((function(){null!==i&&alert(i),m()}),[i,m]);var d=Object(k.useContext)(he);return e.isAuth?A.a.createElement(re.a,{to:"/profile"}):A.a.createElement("div",{className:_e.a.sectionLogin},A.a.createElement("p",null,a),A.a.createElement("div",null,A.a.createElement("button",{onClick:function(){return s("login")}},"Log in")," / ",A.a.createElement("button",{onClick:function(){return s("register")}},"Register now")),A.a.createElement(Oe,{loading:l,authMode:a,onSubmit:function(e){"register"===a?p(e):"login"===a&&f(e)}}))})),je="userData",De=function(e){var t=function(){var e=Object(k.useState)(null),t=Object(C.a)(e,2),n=t[0],a=t[1],r=Object(k.useState)(null),o=Object(C.a)(r,2),s=o[0],c=o[1],l=Object(k.useCallback)((function(e,t){a(e),c(t),localStorage.setItem(je,JSON.stringify({userId:t,token:e}))}),[]),u=Object(k.useCallback)((function(){a(null),c(null),localStorage.removeItem(je)}),[]);return Object(k.useEffect)((function(){var e=JSON.parse(localStorage.getItem(je));e&&e.token&&l(e.token,e.userId)}),[l]),{login:l,logout:u,token:n,userId:s}}(),n=t.token,a=t.login,r=t.logout,o=t.userId,s=!!n;return A.a.createElement(he.Provider,{value:{token:n,login:a,logout:r,userId:o,isAuthentificated:s}},A.a.createElement("div",{className:"appWrapper"},A.a.createElement(fe,null),A.a.createElement(re.d,null,A.a.createElement(re.b,{exact:!0,path:"/",render:function(){return A.a.createElement(re.a,{to:"/profile"})}}),A.a.createElement(re.b,{path:"/login",render:function(){return A.a.createElement(Pe,null)}}),A.a.createElement(re.b,{path:"/profile",render:function(){return A.a.createElement(ce,null)}}),A.a.createElement(re.b,{path:"*",render:function(){return A.a.createElement("div",null,"404 Not found")}}))))},Ne=function(e){y.a.render(A.a.createElement(w.a,null,A.a.createElement(F.a,{store:N},A.a.createElement(De,{store:N}))),document.getElementById("root"))};N.subscribe((function(){N.getState();Ne()})),Ne(N.state),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},27:function(e,t,n){e.exports={postsArea:"MyPosts_postsArea__3ui-L",postsMenu:"MyPosts_postsMenu__2mhfe",postsMenuHeader:"MyPosts_postsMenuHeader__1lNSR",postsMenuSend:"MyPosts_postsMenuSend__3e4ur",posts:"MyPosts_posts__foK_k",postsHeader:"MyPosts_postsHeader__32vSr",postsPost:"MyPosts_postsPost__1_OgN",postsPostImg:"MyPosts_postsPostImg__ALmpG",postsPostTxt:"MyPosts_postsPostTxt__1S_11"}},40:function(e,t,n){e.exports={postsPost:"Post_postsPost__3GT2q",postsPostImg:"Post_postsPostImg__1oTA6",postsPostTxt:"Post_postsPostTxt__2Gb2f",postsPostLike:"Post_postsPostLike__2RygP"}},51:function(e,t){},52:function(e,t){},55:function(e,t,n){e.exports={formDiv:"FormsControlls_formDiv__2_XJD",error:"FormsControlls_error__3LPrZ"}},78:function(e,t,n){e.exports={header:"Header_header__1UTos"}},79:function(e,t,n){e.exports={sectionLogin:"Login_sectionLogin__2NZwH",clickedButton:"Login_clickedButton__3Prea",rem:"Login_rem__1SNPN",summaryError:"Login_summaryError__3Nb8X"}}},[[216,1,2]]]);
//# sourceMappingURL=main.18efc717.chunk.js.map